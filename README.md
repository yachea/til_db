# DB 설계에 대한 규칙

- `중복된 데이터를 제거한다.` 는 것이 목표다.

## 1. `하나의 칸에는 하나의 데이터만` 존재하도록 한다.

- 하나의 칸에 여러개의 데이터가 존재한다면 새로운 테이블을 생성해준다.
- 새로운 테이블에 생성후 FK 를 참조하도록 한다.

## 2. 새로운 테이블로 생성후에도 여러개의 FK 가 겹친다면?

- 중간 테이블을 만든다.
- 여기는 각 테이블의 FK 들을 모아준다.

## 3. 예제

- [구글시트(users, 시트4)](https://docs.google.com/spreadsheets/d/1pbSwp2jPoz4pWuPFI1MA501nJTwuPpOM13oD3l-cRSo/edit?usp=sharing)

# Entity 간의 관계

- Entity 는 테이블을 생각하시면 됩니다.
- students 엔티티가 있다. (학생 테이블)
- subject 엔티티가 있다. (과목 테이블)

## 1단계 어울리는 문장 만들어보기

- `A가(이) B를 ~ 한다.` 적용해보기
- 동사, 즉 서비스 관점에서 문장 만들어보기
- 예) `학생이 과목을 수강한다.`

## 2단계 `하나의` 또는 `여러 개의` 를 적용해본다.

- `A가(이) 하나의 B를 ~ 한다.`
- `A가(이) 여러 개의 B를 ~ 한다.`

- 예) `학생이 하나의 과목을 수강한다.`
- 예) `학생이 여러 개의 과목을 수강한다.`

## 3단계 Entity 간의 관계를 파악한다.

- A 와 B 가 오로지 하나씩만 가지면 `1 대 1 관계`
- A 가 여러개의 B 를 가지면 `1 대 N 관계`
- 여러개의 A 가 하나의 B 를 가지면 `N 대 1 관계`
- A 여러개가 B 여러개를 가진다면 `N 대 N 관계`

## 예시 1

- 사용자 (users), 이메일 (emails)
- 시나리오 : 사용자는 여러개의 이메일을 소유하고 있음.

### 1 단계 적용

- `사용자`가 `이메일`을 소유한다.
- `이메일`은 `사용자`에 의해 소유되어진다.

### 2 단계 적용

- `한명의 사용자`가 `여러개의 이메일`을 소유한다.
- `하나의 이메일`은 `여러명의 사용자`에 의해 소유되어진다. (X)

### 3 단계 적용

- `사용자` : `이메일` = `1 : N 관계` (일 대 다 관계)

## 예시 2

- 가게(store), 판매상품(products)
- 시나리오 : 가게에서 상품을 판다.

### 1 단계 적용

- `가게` 가 `상품` 을 판매한다.
- `상품` 이 `가게` 에서 판매된다.

### 2 단계 적용

- `하나의 가게` 가 `여러 개의 상품` 을 판매한다.
- `여러 개의 상품` 이 `여러 개의 가게` 에서 판매된다.

### 3단계 적용

- `가게` : `상품` = `N : M 관계` (다 대 다 관계)

## 예시 3

- 영화(movies), 배우(actors)

### 1 단계 적용

- `영화`에 `배우`가 출현한다.
- `배우`가 `영화`에 출현한다.

### 2 단계 적용

- `하나의 영화`에 `여러 명의 배우`가 출현한다.
- `한 명의 배우`가 `여러 개의 영화`에 출현한다.
- `여러 명의 배우` 가 `여러 개의 영화`를 찍는다.

### 3 단계 적용

- `영화` : `배우` = `N : M 관계` (다 대 다 관계)

## 예시 4

- 사용자(users), 프로필(profiles)

### 1단계 적용

- `사용자`는 `프로필`이 있다.
- `프로필`은 `사용자`를 설명한다.

### 2단계 적용

- `한 명의 사용자`가 `하나의 프로필`이 있다.
- `한명의 사용자`는 `여러개의` 프로필`이 있다. (X)
- `하나의 프로필`은 `여러명의 사용자`를 설명한다. (X)

### 3단계 적용

= `사용자` : `프로필` = `1 : 1 관계` (일 대 일 관계)

# Entity 간의 관계의 특징

## `1:N 관계`

- 반드시 N 쪽에 FK 가 들어가야한다.

## `N:M 관게`

- 반드시 `중간 테이블`이 생성되어야 한다.
- 중간 테이블에 두 테이블의 FK 가 들어간다.

## `1:1 관계`

- 아무 테이블에나 FK 넣으면 된다.
- `하나로 합쳐도 되지 않을까?`
